title: Start the Microsoft ODBC Data Sources application.
ref: start-odbc
level: 4
stepnum: 1
content: |
  Choose the edition (64-bit or 32-bit) compatible with your platform
  and ODBC driver edition.
---
title: Add a System DSN.
ref: select-tab
level: 4
stepnum: 2
content: |
  .. figure:: /images/bi-connector/windows-odbc-administrator.png
      :alt: Screenshot of the Windows ODBC Administrator application
      :figwidth: 550px

  a. Click :guilabel:`System DSN`.
  b. Click :guilabel:`Add...`
---
title: From the list of available drivers, click :guilabel:`MongoDB ODBC 1.0 Unicode Driver`.
ref: select-odbc
level: 4
stepnum: 3
---
title: Provide the connection settings.
ref: form-fields
level: 4
stepnum: 4
content: |
  a. Click :guilabel:`Details` to expose the lower half of the form.

  b. Add the following required values:

     .. list-table::
        :header-rows: 1
        :widths: 30 70

        * - Field Name
          - Description

        * - :guilabel:`Data Source Name`
          - A name of your choice.

        * - :guilabel:`TCP/IP Server`
          - IP Address of the server where your 
            :binary:`~bin.mongosqld` process is running. If you have 
            enabled |bi-short| on
            `MongoDB Atlas <https://www.mongodb.com/cloud/atlas>`_, 
            you can find the hostname of the server where 
            :binary:`~bin.mongosqld` is running in the 
            `connection information <https://docs.atlas.mongodb.com/connect-to-cluster/#connect-to-your-cluster>`_
            for your cluster.

        * - :guilabel:`Port`
          - Port number of your :binary:`~bin.mongosqld`
            process.

        * - :guilabel:`Database`
          - The name of the database to connect to, e.g. ``test``.
---
title: (Optional) If authentication is enabled, add the authentication settings. 
ref: authentication-form-fields
level: 4
stepnum: 5
content: |

  Add the following values when 
  :option:`--auth <mongosqld --auth>` enabled or when connecting to 
  an Atlas |bi-short| instance.
   
  .. list-table::
     :header-rows: 1
     :widths: 30 70

     * - Field Name
       - Description

     * - :guilabel:`User`
       - Username of the :manual:`MongoDB user </core/security-users/>`
         who is authenticated to use your target database.

         .. include:: /includes/auth-options.rst

         .. include:: /includes/fact-username-auth-db.rst

     * - :guilabel:`Password`
       - Authenticated user's password.

     * - :guilabel:`Authentication`
       - Default authentication method. When using the |odbc-driver|, 
         this field is not required.

         To use the :doc:`authentication plugin
         </tutorial/install-auth-plugin-c>` in conjunction with
         another ODBC driver, set this value to ``mongosql_auth``.
---
title: (Optional) If SSL is enabled, add the SSL settings.
ref: form-fields-ssl
level: 4
stepnum: 6
content: |
  a. Click :guilabel:`Details >>`.
  b. Click the :guilabel:`SSL` tab.
  c. Add the following values:

     .. list-table::
        :header-rows: 1
        :widths: 30 70

        * - Field Name
          - Description

        * - :guilabel:`SSL Key`
          - The location of the client/server key file.

        * - :guilabel:`SSL Cert`
          - The location of the client/server certificate file.
            
            Required when running with 
            :option:`--auth <mongosqld --auth>`
            enabled and when connecting to an Atlas |bi-short| 
            instance. Username of the :manual:`MongoDB user
            </core/security-users/>` who is authenticated to use your
            target database.

        * - :guilabel:`SSL Mode`
          - Set to ``REQUIRED`` to require an encrypted channel. If an
            encyrpted channel is not provided, the connection fails.
---
title: Click :guilabel:`Test` to test the ODBC connection.
ref: click-test
level: 4
stepnum: 7
content: |
  If the connection is successful, click :guilabel:`OK` to add the
  :abbr:`DSN (Data Source Name)`. If the connection fails,
  check to make sure your MongoDB user is correctly authenticated for
  the database named in the connection.
...
