title: Download and install iODBC.
ref: download-iodbc
stepnum: 1
level: 4
content: |
  Download and install `iODBC <http://opldownload.s3.amazonaws.com/uda/components/7.0/universal-apple-macosx10.7-32/mxkozzzz.dmg>`_.
---
title: Download the MongoDB ODBC driver.
ref: download-mongodb-odbc-driver-macos
level: 4
stepnum: 2
content: |

  a. Download the |odbc-driver|.

  b. Move the files to the desired directory, for example `/Library/ODBC/`:

     .. code-block:: sh

        cp ./{libmdbodbca.so,libmdbodbcw.so} /Library/ODBC/

  The files correspond to the following drivers:

  .. list-table::
     :widths: 50 50
     :header-rows: 1
     
     * - Driver
       - File

     * - MongoDB ODBC ANSI Driver
       - libmdbodbca.so

     * - MongoDB ODBC Unicode Driver
       - libmdbodbcw.so
---
title: Add the MongoDB ODBC driver to iODBC
ref: add-driver-macos
level: 4
stepnum: 3
content: |

  a. Open :guilabel:`iODBC Administrator64`.
  
  #. Click :guilabel:`ODBC Drivers`.
  
  #. Click :guilabel:`Add a Driver`. Enter the following values:
  
     1. For :guilabel:`Description of the driver`, enter a name for the
        driver, for example, `MongoDB ODBC Unicode Driver`.

     #. For :guilabel:`Driver file name`, enter the path to the
        driver downloaded in the previous step.

        .. example::

           ``/Library/ODBC/libmdbodbcw.so``

     #. For :guilabel:`Driver defined as`, select :guilabel:`User`.

     #. Click :guilabel:`OK`.
---
title: Create a user DSN in iODBC
ref: create-user-dsn-macos
level: 4
stepnum: 4
content: |

  a. From iODBC, click :guilabel:`User DSN`, then click
     :guilabel:`Add`.

  #. Select the driver you added in the previous step, for example
     :guilabel:`MongoDB ODBC Driver`, then click :guilabel:`Finish`.

  #. Enter a :guilabel:`Data Source Name (DSN)` and optionally enter
     a :guilabel:`Comment`.

  .. note::

     Do not close the setup window and proceed to the next step.
---
title: Add the necessary keywords.
ref: keywords-dsn-macos
level: 4
stepnum: 5
content: |
  Add the following keyword value pairs by clicking the
  :guilabel:`+` icon, then double-clicking the :guilabel:`...` for
  each keyword and value:
  
  .. list-table::
     :widths: 50 50
     :header-rows: 1
  
     * - Keyword
       - Value
  
     * - **SERVER**
       - The hostname or IP address of the |bi| host.
  
     * - **PORT**
       - The :abbr:`IANA (Internet Assigned Numbers Authority)`
         `port number <https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml>`_
         for the |bi|. The default is ``3307``.

     * - **DATABASE**
       - Optional. The database to use after connecting.

  .. include:: /includes/fact-odbc-parameters.rst

  For example, your user DSN configuration should look similar to
  the following:
  
  .. figure:: /images/bi-connector/iodbc-dsn-config.png
     :alt: iODBC DSN configuration
     :figwidth: 491px
     :align: center

  .. note::

     Do not close the setup window. Proceed to the next step.
---
title: (Optional) If authentication is enabled, add the authentication keywords.
ref: authentication-keywords-dsn-macos
level: 4
stepnum: 6
content: |
  Add the following keyword value pairs by clicking the
  :guilabel:`+` icon, then double-clicking the :guilabel:`...` for
  each keyword and value:
  
  .. list-table::
     :widths: 50 50
     :header-rows: 1
  
     * - Keyword
       - Value
  
     * - **UID**
       - The username for the user that can access the active
         |bi| database.
  
         Unless you specified a ``defaultMechanism`` in your
         |bi| :ref:`configuration file <config-format>`, you
         must append the authenticating database to the username.
  
         .. example::
  
            The user ``myTestUser`` is authenticated against the
            ``admin`` database:
  
            ``myTestUser?source=admin``
  
         - If you are using Username and Password (``SCRAM-SHA-1``)
           authentication, the expected authenticating database is
           ``admin``.
  
         - If you are using LDAP (``PLAIN``) authentication, the
           expected authenticating database is ``$external``.
  
     * - **PWD**
       - The password associated with the :guilabel:`UID`.

  .. include:: /includes/fact-odbc-parameters.rst

  For example, your user DSN configuration should look similar to
  the following:
  
  .. figure:: /images/bi-connector/iodbc-dsn-config-auth.png
     :alt: iODBC DSN configuration
     :figwidth: 491px
     :align: center
---
title: (Optional) If SSL is enabled, add the SSL keywords.
ref: ssl-keywords-dsn-macos
level: 4
stepnum: 7
content: |
  Add the following keyword value pairs by clicking the
  :guilabel:`+` icon, then double-clicking the :guilabel:`...` for
  each keyword and value:

  .. list-table::
     :widths: 50 50
     :header-rows: 1

     * - Keyword
       - Value

     * - **SSLKEY**
       - The path to the .pem key file.

     * - **SSLCERT**
       - The path to the SSL certificate.

     * - **SSLMODE**
       - Set to ``REQUIRED``.

  .. note::

     Depending on your SSL implementation you may need to set some of
     the following iODBC keywords:

     .. list-table::
        :widths: 50 50
        :header-rows: 1

        * - Keyword
          - Value

        * - ``SSLCA``
          - The path to the SSL certificate authority file

        * - ``ENABLE_CLEARTEXT_PLUGIN``
          - Set to ``1`` to enable cleartext authentication.

  .. include:: /includes/fact-odbc-parameters.rst

  For example, your user DSN configuration should look similar to
  the following:
  
  .. figure:: /images/bi-connector/iodbc-dsn-config-auth-ssl.png
     :alt: iODBC DSN configuration
     :figwidth: 491px
     :align: center
---
title: Finish creating the DSN.
ref: finalize-user-dsn-macos
level: 4
stepnum: 8
content: |
  a. Click :guilabel:`OK` to finish creating the DSN.
  b. Test the connection by clicking the :guilabel:`Test` button.
  c. Click :guilabel:`OK` to close iODBC.
...
